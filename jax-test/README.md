# JAX vs. NumPy Performance Benchmark: Cosine Similarity

This is a script to benchmark the execution speed of a moderately complex mathematical operation: cosine similarity between two large matrices using three methods: standard NumPy, raw JAX, and JAX with Just-In-Time (JIT) compilation.

The vector dimension D was set to 768 to simulate comparing sentence or paragraph embeddings generated by pre-trained language models (e.g., BERT-base or Sentence-BERT). This ensures the benchmark measures performance under realistic high-dimensional computational load.

## Results

| Size (N) | NumPy (ms) | JAX (non-JIT) (ms) | JAX (JIT) (ms) |
|------------|------------|--------------------|----------------|
| 10         | 0.0722     | 0.6337             | 0.2156         |
| 25         | 0.0811     | 0.7624             | 0.2463         |
| 50         | 0.5053     | 0.8514             | 0.4448         |
| 100        | 0.2425     | 1.2466             | 0.5367         |
| 150        | 0.5194     | 1.2308             | 0.6668         |
| 200        | 0.8242     | 1.6279             | 1.0422         |
| 250        | 1.2563     | 1.4979             | 0.8853         |
| 300        | 8.1342     | 1.8771             | 1.5519         |
| 350        | 8.1885     | 2.4520             | 1.3154         |
| 400        | 9.3717     | 2.5321             | 1.5621         |
| 450        | 8.8874     | 2.9351             | 2.4128         |
| 500        | 10.1537    | 3.8158             | 2.5090         |


## Conclusion

1. The performance advantage shifts to JAX (JIT) around N=250. Below this size (e.g., N=100), the overhead of JAX setup means standard NumPy is faster.
2. At N=500, NumPy takes over 10 ms, while JAX (JIT) completes the calculation in 2.5 ms, showing a speedup of approximately 4x.
3. JAX (non-JIT) is consistently the slowest for smaller arrays due to framework overhead but quickly becomes faster than NumPy for larger arrays (N â‰¥ 300) due to JAX's optimized XLA backend structure.




## Try it out yourself!

Requirements:
- Python >= 3.11
- jax == 0.7.x
- numpy == 2.3.x

(Optional: uv)
Create a venv, install dependencies and run main.py
